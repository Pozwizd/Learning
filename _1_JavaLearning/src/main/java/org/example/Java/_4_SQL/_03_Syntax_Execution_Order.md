# 3. Основы синтаксиса и Порядок выполнения (Syntax & Execution Order)

Понимание того, как база данных обрабатывает запрос, важнее, чем просто знание ключевых слов.

## Лексическая структура
*   **Ключевые слова (Keywords)**: Зарезервированные слова (`SELECT`, `FROM`, `WHERE`). Обычно пишутся в UPPERCASE для читаемости, но SQL регистронезависим (case-insensitive) к ключевым словам.
*   **Идентификаторы (Identifiers)**: Имена таблиц, колонок. Если имя содержит пробелы или спецсимволы, его нужно брать в кавычки (двойные `"` в стандарте ANSI, обратные апострофы `` ` `` в MySQL).
*   **Литералы (Literals)**: Конкретные значения.
    *   Строки: `'Hello World'` (одинарные кавычки).
    *   Числа: `123`, `45.67`.
*   **Комментарии**:
    *   Однострочный: `-- комментарий`
    *   Многострочный: `/* комментарий */`

## Порядок написания запроса (Lexical Order)
Так мы пишем запрос:
```sql
SELECT ...
FROM ...
JOIN ...
WHERE ...
GROUP BY ...
HAVING ...
ORDER BY ...
LIMIT ...
```

## Порядок логического выполнения (Logical Processing Order)
Так база данных выполняет запрос. Это критично для понимания работы алиасов и фильтрации.

1.  **FROM / JOIN**: Определяется набор данных. Сначала берутся таблицы, выполняются соединения.
2.  **WHERE**: Фильтрация строк. На этом этапе **нельзя** использовать алиасы из `SELECT`, так как `SELECT` еще не выполнен. Также нельзя использовать агрегатные функции.
3.  **GROUP BY**: Группировка оставшихся строк.
4.  **HAVING**: Фильтрация групп. Здесь можно использовать агрегатные функции.
5.  **SELECT**: Выборка столбцов, вычисление выражений, применение оконных функций. Только здесь появляются алиасы столбцов.
6.  **DISTINCT**: Удаление дубликатов.
7.  **ORDER BY**: Сортировка. Здесь уже можно использовать алиасы из `SELECT`.
8.  **LIMIT / OFFSET**: Ограничение количества строк.

## Пример
```sql
SELECT Country, COUNT(*) AS UserCount  -- 5. SELECT
FROM Users                             -- 1. FROM
WHERE IsActive = TRUE                  -- 2. WHERE
GROUP BY Country                       -- 3. GROUP BY
HAVING COUNT(*) > 10                   -- 4. HAVING
ORDER BY UserCount DESC                -- 7. ORDER BY
LIMIT 5;                               -- 8. LIMIT
```
